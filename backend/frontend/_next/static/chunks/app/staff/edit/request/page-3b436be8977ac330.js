(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5218],{646:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},968:(e,t,a)=>{"use strict";a.d(t,{b:()=>l});var s=a(2115),n=a(3655),d=a(5155),r=s.forwardRef((e,t)=>(0,d.jsx)(n.sG.label,{...e,ref:t,onMouseDown:t=>{var a;t.target.closest("button, input, select, textarea")||(null===(a=e.onMouseDown)||void 0===a||a.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));r.displayName="Label";var l=r},2714:(e,t,a)=>{"use strict";a.d(t,{J:()=>o});var s=a(5155),n=a(2115),d=a(968),r=a(2085),l=a(3999);let i=(0,r.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(d.b,{ref:t,className:(0,l.cn)(i(),a),...n})});o.displayName=d.b.displayName},3403:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=a(3464).A.create({baseURL:"/api"})},5784:(e,t,a)=>{"use strict";a.d(t,{bq:()=>u,eb:()=>g,gC:()=>x,l6:()=>c,yv:()=>h});var s=a(5155),n=a(2115),d=a(8715),r=a(6474),l=a(7863),i=a(5196),o=a(3999);let c=d.bL;d.YJ;let h=d.WT,u=n.forwardRef((e,t)=>{let{className:a,children:n,...l}=e;return(0,s.jsxs)(d.l9,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[n,(0,s.jsx)(d.In,{asChild:!0,children:(0,s.jsx)(r.A,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=d.l9.displayName;let m=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(d.PP,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,s.jsx)(l.A,{className:"h-4 w-4"})})});m.displayName=d.PP.displayName;let p=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(d.wn,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,s.jsx)(r.A,{className:"h-4 w-4"})})});p.displayName=d.wn.displayName;let x=n.forwardRef((e,t)=>{let{className:a,children:n,position:r="popper",...l}=e;return(0,s.jsx)(d.ZL,{children:(0,s.jsxs)(d.UC,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:r,...l,children:[(0,s.jsx)(m,{}),(0,s.jsx)(d.LM,{className:(0,o.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,s.jsx)(p,{})]})})});x.displayName=d.UC.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(d.JU,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...n})}).displayName=d.JU.displayName;let g=n.forwardRef((e,t)=>{let{className:a,children:n,...r}=e;return(0,s.jsxs)(d.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(d.VF,{children:(0,s.jsx)(i.A,{className:"h-4 w-4"})})}),(0,s.jsx)(d.p4,{children:n})]})});g.displayName=d.q7.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(d.wv,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a),...n})}).displayName=d.wv.displayName},8145:(e,t,a)=>{"use strict";a.d(t,{E:()=>l});var s=a(5155);a(2115);var n=a(2085),d=a(3999);let r=(0,n.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:a,...n}=e;return(0,s.jsx)("div",{className:(0,d.cn)(r({variant:a}),t),...n})}},8482:(e,t,a)=>{"use strict";a.d(t,{BT:()=>o,Wu:()=>c,ZB:()=>i,Zp:()=>r,aR:()=>l});var s=a(5155),n=a(2115),d=a(3999);let r=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,d.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...n})});r.displayName="Card";let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...n})});l.displayName="CardHeader";let i=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,d.cn)("text-2xl font-semibold leading-none tracking-tight",a),...n})});i.displayName="CardTitle";let o=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,d.cn)("text-sm text-muted-foreground",a),...n})});o.displayName="CardDescription";let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,d.cn)("p-6 pt-0",a),...n})});c.displayName="CardContent",n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,d.cn)("flex items-center p-6 pt-0",a),...n})}).displayName="CardFooter"},8691:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]])},9074:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},9663:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var s=a(5155),n=a(5695),d=a(2115),r=a(7168),l=a(8145),i=a(8482),o=a(5784),c=a(8691),h=a(9074),u=a(646),m=a(7949),p=a(7746),x=a(3568),g=a(395),f=a(3403),y=a(2714),v=a(9852);function b(){var e,t,a,b,j,N,_,w;let{user:A,logout:C}=(0,g.A)(),k=(0,n.useRouter)(),[R,D]=(0,d.useState)(null),S=(0,n.useSearchParams)().get("requestId")||"",[M,B]=(0,d.useState)([]),[K,T]=(0,d.useState)({}),[q,E]=(0,d.useState)({donors:[]}),[F,P]=(0,d.useState)({}),[L,Z]=(0,d.useState)(""),[z,I]=(0,d.useState)({}),[V,H]=(0,d.useState)([]),[J,G]=(0,d.useState)(""),[O,U]=(0,d.useState)(""),[W,$]=(0,d.useState)([]);function X(e,t,a){let s=e.find(e=>e.blood_type===t&&e.component===a);return s?s.quantity:0}let Y=()=>new Date().toISOString().split("T")[0],Q=(e,t,a)=>{I(s=>{var n,d;return{...s,[e]:{date:"date"===t?a:(null===(n=s[e])||void 0===n?void 0:n.date)||"",comment:"comment"===t?a:(null===(d=s[e])||void 0===d?void 0:d.comment)||""}}})},ee=async()=>{try{var e,t,a;if(!F.blood_type_needed||!(null===(e=F.recipient_id)||void 0===e?void 0:e._id)||!(null===(t=K.user_id)||void 0===t?void 0:t._id)||!(null===(a=K.hospital)||void 0===a?void 0:a._id)){x.Ay.error("Thiếu th\xf4ng tin cần thiết");return}let s=V.find(e=>e.blood_type===F.blood_type_needed);if(!s){x.Ay.error("Kh\xf4ng t\xecm thấy m\xe1u ph\xf9 hợp trong kho");return}console.log(K.hospital._id),await f.A.post("/staff/donation-blood-inventory",{inventory_item:s._id,recipient_id:F.recipient_id._id,donation_date:J,volume:F.amount_needed,updated_by:K.user_id._id,notes:O,hospital:K.hospital._id}),await f.A.put("/staff/blood-requests/".concat(S,"/status"),{status:"matched"}),x.Ay.success("Đ\xe3 x\xe1c nhận lấy m\xe1u từ kho"),k.push("/staff/dashboard")}catch(e){console.error("Lỗi x\xe1c nhận lấy m\xe1u từ kho:",e),x.Ay.error("X\xe1c nhận thất bại, vui l\xf2ng thử lại!")}},et=e=>{let t=new Date(e),a=String(t.getDate()).padStart(2,"0"),s=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear();return"".concat(a,"/").concat(s,"/").concat(n)};function ea(e){let t={whole:"M\xe1u to\xe0n phần",plasma:"Huyết tương",rbc:"Hồng cầu",RBC:"Hồng cầu",platelet:"Tiểu cầu"};return t[null==e?void 0:e.toLowerCase()]||t[e]||e}(0,d.useEffect)(()=>{let e=async(e,t,a)=>{try{let s=(await f.A.get("/hospital/")).data.hospitals,n=(e,t,a,s)=>{let n=(a-e)*Math.PI/180,d=(s-t)*Math.PI/180,r=Math.sin(n/2)**2+Math.cos(e*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(d/2)**2,l=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r));return 6371*l},d=s.filter(s=>n(e,t,s.latitude,s.longitude)<=a).map(e=>({_id:e._id,name:e.name,address:e.address,phone:e.phone}));if($(d),d.length>0)return x.Ay.success("T\xecm thấy ".concat(d.length," bệnh viện trong ").concat(a," km!")),d;x.Ay.error("Kh\xf4ng t\xecm thấy bệnh viện n\xe0o trong ".concat(a," km."))}catch(e){console.error("Lỗi lấy danh s\xe1ch bệnh viện:",e),x.Ay.error("Đ\xe3 xảy ra lỗi khi t\xecm bệnh viện!")}};async function t(){try{var t,a;if(!(null==A?void 0:A._id))return;let s=(await f.A.get("/users/staff-profiles/active/".concat(A._id))).data.staffProfile;if(T(s),null==s?void 0:null===(t=s.hospital)||void 0===t?void 0:t._id){let t=await f.A.get("/staff/blood-request/get-by-id/".concat(S));P(t.data),Z((null===(a=t.data)||void 0===a?void 0:a.status)||"");let n=(await e(t.data.hospital.latitude,t.data.hospital.longitude,t.data.distance)).map(e=>e._id),d=await f.A.post("/users/donors/by-hospitals-and-bloodtype",{hospitalIds:n,recipientBloodType:t.data.blood_type_needed});E(d.data);let r=await f.A.get("/blood-in/blood-inventory/hospital/".concat(s.hospital._id));H(r.data.inventories)}}catch(e){console.error("Lỗi lấy th\xf4ng tin nh\xe2n vi\xean hoặc bệnh viện:",e)}}(null==A?void 0:A._id)&&t()},[A,S]),(0,d.useEffect)(()=>{D({recipient_id:{full_name:"Nguyễn Văn A"},blood_type_needed:"O+",amount_needed:2,status:"pending",is_emergency:!0,createdAt:new Date().toISOString()}),B([{_id:"donor1",user_id:{full_name:"Nguyễn Văn B",email:"nguyenvanb@gmail.com",phone:"0123456789"},distance:5.2,blood_type:"A+",donation_start_date:"2024-06-15T00:00:00Z"},{_id:"donor2",user_id:{full_name:"L\xea Văn C",email:"levanc@gmail.com",phone:"0987654321"},distance:8.7,blood_type:"A+",donation_start_date:"2024-06-15T00:00:00Z"}])},[]);let es=async e=>{try{await f.A.put("/staff/blood-requests/".concat(S,"/status"),{status:e}),x.Ay.success("Đ\xe3 thay đổi status th\xe0nh ".concat(e)),P(t=>({...t,status:e}))}catch(e){x.Ay.error("Đ\xe3 xảy ra lỗi khi cập nhật trạng th\xe1i. Vui l\xf2ng thử lại!"),console.error(e)}},en=async e=>{try{var t,a,s;if(!(null===(t=F.recipient_id)||void 0===t?void 0:t._id)||!(null===(a=F.components_needed)||void 0===a?void 0:a[0])||!(null===(s=K.user_id)||void 0===s?void 0:s._id)){x.Ay.error("Thiếu th\xf4ng tin cần thiết");return}let n=z[e];if(!(null==n?void 0:n.date)){x.Ay.error("Vui l\xf2ng chọn ng\xe0y hiến m\xe1u");return}let d=q.donors.find(t=>t._id===e);if(!d){x.Ay.error("Kh\xf4ng t\xecm thấy th\xf4ng tin người hiến");return}await f.A.post("/staff/donation",{donor_id:d.user_id._id,recipient_id:F.recipient_id._id,donation_date:n.date,donation_type:F.components_needed[0],volume:F.amount_needed,status:"scheduled",updated_by:K.user_id._id,notes:n.comment||""}),await f.A.put("/staff/blood-requests/".concat(S,"/status"),{status:"matched"}),x.Ay.success("Th\xe0nh c\xf4ng y\xeau cầu hiến m\xe1u"),k.push("/staff/dashboard")}catch(e){x.Ay.error("Đ\xe3 xảy ra lỗi khi cập nhật trạng th\xe1i. Vui l\xf2ng thử lại!"),console.error(e)}};return R?(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Header,{}),(0,s.jsxs)("div",{className:"container mx-auto py-8 space-y-8",children:[(0,s.jsxs)(i.Zp,{className:"shadow-lg rounded-2xl",children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{className:"text-2xl font-bold",children:"\uD83E\uDE78 Chi tiết y\xeau cầu m\xe1u"}),(0,s.jsx)(i.BT,{className:"text-gray-600",children:"Th\xf4ng tin chi tiết & cập nhật trạng th\xe1i"})]}),(0,s.jsxs)(i.Wu,{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Bệnh nh\xe2n:"})," ",(null==F?void 0:null===(e=F.recipient_id)||void 0===e?void 0:e.full_name)||"Kh\xf4ng r\xf5"]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Email:"})," ",(null==F?void 0:null===(t=F.recipient_id)||void 0===t?void 0:t.email)||"Kh\xf4ng r\xf5"]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Điện thoại:"})," ",(null==F?void 0:null===(a=F.recipient_id)||void 0===a?void 0:a.phone)||"Kh\xf4ng r\xf5"]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Nh\xf3m m\xe1u cần:"})," ",(null==F?void 0:F.blood_type_needed)||"Kh\xf4ng r\xf5"]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Th\xe0nh phần cần:"})," ",(null==F?void 0:null===(b=F.components_needed)||void 0===b?void 0:b.map(e=>ea(e)).join(", "))||"Kh\xf4ng r\xf5"]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Số lượng:"})," ",(null==F?void 0:F.amount_needed)||"Kh\xf4ng r\xf5"," đơn vị"]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Khoảng c\xe1ch:"})," ",(null==F?void 0:F.distance)!==void 0?"".concat(F.distance," km"):"Kh\xf4ng r\xf5"]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Bệnh viện:"})," ",(null==F?void 0:null===(j=F.hospital)||void 0===j?void 0:j.name)||"Kh\xf4ng r\xf5"]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Địa chỉ BV:"})," ",(null==F?void 0:null===(N=F.hospital)||void 0===N?void 0:N.address)||"Kh\xf4ng r\xf5"]}),(0,s.jsxs)("div",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"T\xecnh trạng:"})," ",(0,s.jsx)(l.E,{className:"capitalize",children:{pending:"Chờ duyệt",approved:"Đ\xe3 duyệt",matched:"Đ\xe3 gh\xe9p",in_progress:"Đang xử l\xfd",completed:"Ho\xe0n tất",cancelled:"Đ\xe3 hủy",rejected:"Từ chối",scheduled:"Đ\xe3 l\xean lịch",fulfilled:"Đ\xe3 thực hiện"}[w=(null==F?void 0:F.status)||"Đang chờ"]||w})]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Khẩn cấp:"})," ",(null==F?void 0:F.is_emergency)?"C\xf3":"Kh\xf4ng"]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Ghi ch\xfa:"})," ",(null==F?void 0:F.comment)||"Kh\xf4ng c\xf3"]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Ng\xe0y tạo:"})," ",(null==F?void 0:F.createdAt)?et(F.createdAt):"Kh\xf4ng r\xf5"]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Cập nhật lần cuối:"})," ",(null==F?void 0:F.updatedAt)?et(F.updatedAt):"Kh\xf4ng r\xf5"]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"font-medium text-gray-800",children:"\uD83D\uDEE0 Cập nhật trạng th\xe1i:"}),(0,s.jsxs)(o.l6,{onValueChange:Z,value:L,children:[(0,s.jsx)(o.bq,{className:"w-full md:w-[300px] border-gray-300",children:(0,s.jsx)(o.yv,{placeholder:"Chọn trạng th\xe1i"})}),(0,s.jsx)(o.gC,{children:[{key:"pending",label:"Đang chờ duyệt"},{key:"cancelled",label:"Đ\xe3 hủy"},{key:"rejected",label:"Bị từ chối"}].map(e=>(0,s.jsx)(o.eb,{value:e.key,children:e.label},e.key))})]}),(0,s.jsx)(r.$,{className:"mt-2 bg-blue-600 text-white hover:bg-blue-700",disabled:!L||L===(null==F?void 0:F.status),onClick:()=>es(L),children:"Cập nhật trạng th\xe1i"})]})]})]}),(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(i.ZB,{className:"text-sm font-medium",children:"T\xecnh trạng y\xeau cầu gần nhất"}),(0,s.jsx)(c.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(i.Wu,{children:V.length>0&&F.blood_type_needed&&F.amount_needed&&function(e,t,a){let s=e.find(e=>e.blood_type===t&&"RBC"===e.component);return s&&s.quantity>=a}(V,F.blood_type_needed,F.amount_needed)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"text-green-600 font-bold mb-2",children:["✅ C\xf3 đủ m\xe1u (",F.blood_type_needed,") trong kho"]}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mb-4",children:["Cần ",F.amount_needed," đơn vị nh\xf3m ",F.blood_type_needed]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm font-semibold text-blue-600 bg-blue-50 px-4 py-2 rounded-lg border border-blue-200 w-fit mb-5",children:["\uD83D\uDC89 Hiện c\xf3: ",X(V,F.blood_type_needed,"RBC")," đơn vị ",ea("RBC")]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)(y.J,{htmlFor:"warehouse-donation-date",children:"Ng\xe0y hiến m\xe1u"}),(0,s.jsxs)("div",{className:"relative mt-5",children:[(0,s.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),(0,s.jsx)(v.p,{id:"warehouse-donation-date",type:"date",value:J,onChange:e=>G(e.target.value),min:Y(),className:"pl-10",required:!0})]})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)(y.J,{htmlFor:"warehouse-comment",children:"Ghi ch\xfa"}),(0,s.jsx)(v.p,{id:"warehouse-comment",placeholder:"Nhập ghi ch\xfa khi lấy m\xe1u từ kho...",value:O,onChange:e=>U(e.target.value),className:"mt-5"})]}),(0,s.jsx)(r.$,{onClick:ee,className:"bg-purple-600 text-white hover:bg-purple-700",disabled:!J,children:"✅ X\xe1c nhận lấy m\xe1u từ kho"})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"text-red-600 font-bold",children:["❌ Kh\xf4ng đủ m\xe1u ",F.blood_type_needed||"N/A"," trong kho"]}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mb-1",children:["Cần ",F.amount_needed," đơn vị nh\xf3m ",F.blood_type_needed]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm font-semibold text-red-600 bg-red-50 px-4 py-2 rounded-lg border border-red-200 w-fit mb-5",children:["\uD83D\uDC89 Hiện c\xf3: ",F.blood_type_needed?X(V,F.blood_type_needed,"RBC"):0," đơn vị ",ea("RBC")]})]})})]}),(0,s.jsxs)(i.Zp,{className:"shadow-lg rounded-2xl",children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{className:"text-2xl font-bold",children:"\uD83E\uDE7A Người hiến m\xe1u khả dụng"}),(0,s.jsx)(i.BT,{className:"text-gray-600",children:"Danh s\xe1ch người hiến ph\xf9 hợp theo nh\xf3m m\xe1u & khoảng c\xe1ch"})]}),(0,s.jsx)(i.Wu,{className:"space-y-4",children:(null===(_=q.donors)||void 0===_?void 0:_.length)===0?(0,s.jsx)("p",{className:"text-gray-600",children:"Kh\xf4ng t\xecm thấy người hiến ph\xf9 hợp."}):Array.isArray(null==q?void 0:q.donors)&&q.donors.map(e=>{var t,a;return(0,s.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center p-4 border rounded-xl bg-gray-50 hover:shadow transition",children:[(0,s.jsxs)("div",{className:"space-y-1 mb-4 md:mb-0",children:[(0,s.jsx)("p",{className:"font-semibold text-lg",children:e.user_id.full_name}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[e.user_id.email," | \uD83D\uDCDE ",e.user_id.phone," | ",e.hospital.name]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Nh\xf3m m\xe1u: ",e.blood_type||"Kh\xf4ng r\xf5"]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Bắt đầu hiến từ: ",et(e.availability_date)]})]}),(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:space-x-4 space-y-2 md:space-y-0 w-full md:w-auto",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)(y.J,{className:"mb-5",htmlFor:"donation-date-".concat(e._id),children:"Ng\xe0y hiến m\xe1u"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),(0,s.jsx)(v.p,{id:"donation-date-".concat(e._id),type:"date",value:(null===(t=z[e._id])||void 0===t?void 0:t.date)||"",onChange:t=>Q(e._id,"date",t.target.value),min:Y(),className:"pl-10",required:!0})]})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)(y.J,{className:"mb-5",htmlFor:"comment-".concat(e._id),children:"Ghi ch\xfa"}),(0,s.jsx)(v.p,{id:"comment-".concat(e._id),type:"text",value:(null===(a=z[e._id])||void 0===a?void 0:a.comment)||"",onChange:t=>Q(e._id,"comment",t.target.value),placeholder:"Nhập ghi ch\xfa...",className:"w-full md:w-48"})]}),(0,s.jsxs)(r.$,{size:"sm",className:"bg-green-600 text-white hover:bg-green-700",onClick:()=>en(e._id),children:[(0,s.jsx)(u.A,{className:"w-4 h-4 mr-1"}),"Gh\xe9p"]})]})]},e._id)})})]}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(r.$,{onClick:()=>k.back(),variant:"outline",className:"px-6 py-3 rounded-xl",children:"← Quay lại"})})]}),(0,s.jsx)(x.l$,{position:"top-center",containerStyle:{top:80}}),(0,s.jsx)(p.Footer,{})]}):(0,s.jsx)("p",{className:"p-8 text-center text-gray-600",children:"Đang tải dữ liệu..."})}},9852:(e,t,a)=>{"use strict";a.d(t,{p:()=>r});var s=a(5155),n=a(2115),d=a(3999);let r=n.forwardRef((e,t)=>{let{className:a,type:n,...r}=e;return(0,s.jsx)("input",{type:n,className:(0,d.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...r})});r.displayName="Input"},9943:(e,t,a)=>{Promise.resolve().then(a.bind(a,9663))}},e=>{var t=t=>e(e.s=t);e.O(0,[6237,6222,3464,3568,461,1975,7949,8441,1684,7358],()=>t(9943)),_N_E=e.O()}]);