(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[564],{2337:()=>{},3095:(e,a,t)=>{Promise.resolve().then(t.bind(t,6596))},6596:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>S});var r=t(5155);t(2337);var s=t(2115),l=t(7168),i=t(8482),n=t(9852),o=t(2714),d=t(5784),c=t(3695),h=t(9026),m=t(5339),x=t(1007),g=t(8691),u=t(1264),p=t(9074),f=t(9420),v=t(4516),b=t(646),j=t(6874),y=t.n(j),N=t(5695),w=t(7949),_=t(7746),A=t(3403),k=t(395),C=t(3568),T=t(3852);let F=e=>{let{value:a,onChange:t}=e;return(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)(n.p,{value:a,onChange:e=>{t(e.target.value)},placeholder:"Nhập địa chỉ",className:"pl-3"})})};function S(){let{user:e,setUser:a,logout:t}=(0,k.A)(),j=e=>{let a=new Date(e),t=a.getFullYear(),r=String(a.getMonth()+1).padStart(2,"0"),s=String(a.getDate()).padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(s)},[S,M]=(0,s.useState)({name:(null==e?void 0:e.full_name)||"",email:(null==e?void 0:e.email)||"",password:"",confirmPassword:"",phone:(null==e?void 0:e.phone)||"",address:(null==e?void 0:e.address)||"",bloodType:"",gender:(null==e?void 0:e.gender)||"",date_of_birth:(null==e?void 0:e.date_of_birth)?j(e.date_of_birth):"",role:(null==e?void 0:e.role)||"",certificateDonor:"",certificateRecipient:"",hospital_name:"",hospitalId:"",availability_date:"",agreeTerms:!1}),[D,I]=(0,s.useState)(null),[q,V]=(0,s.useState)(null),[J,P]=(0,s.useState)(!0),[R,B]=(0,s.useState)(""),[K,E]=(0,s.useState)(null),[O,L]=(0,s.useState)([]),[z,H]=(0,s.useState)(10),[$,Z]=(0,s.useState)(null),[G,U]=(0,s.useState)(!0),[W,Y]=(0,s.useState)(-1),[Q,X]=(0,s.useState)(""),[ee,ea]=(0,s.useState)(""),et=new Date().toISOString().split("T")[0],er=e=>{M(a=>({...a,hospitalId:e._id})),ea(e.name),X(e.name),U(!1),Y(-1)},es=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/đ/g,"d").replace(/Đ/g,"D"),el=O.filter(e=>es(e.name.toLowerCase()).includes(es(Q.toLowerCase()))),ei=()=>{if(!navigator.geolocation){C.Ay.error("Tr\xecnh duyệt kh\xf4ng hỗ trợ định vị!"),Z(!1);return}navigator.geolocation.getCurrentPosition(e=>{Z(!0),C.Ay.success("Đ\xe3 cho ph\xe9p định vị!")},e=>{console.error("Từ chối định vị:",e),Z(!1),C.Ay.error("Bạn đ\xe3 từ chối quyền định vị, t\xednh năng t\xecm kiếm sẽ bị kho\xe1.")})};(0,s.useEffect)(()=>{navigator.geolocation.getCurrentPosition(async e=>{let{latitude:a,longitude:t}=e.coords;E({lat:a,lng:t});try{let e=(await A.A.get("/hospital/")).data.hospitals,r=(e,a,t,r)=>{let s=(t-e)*Math.PI/180,l=(r-a)*Math.PI/180,i=Math.sin(s/2)**2+Math.cos(e*Math.PI/180)*Math.cos(t*Math.PI/180)*Math.sin(l/2)**2,n=2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i));return 6371*n},s=e.filter(e=>30>=r(a,t,e.latitude,e.longitude)).map(e=>({_id:e._id,name:e.name,address:e.address,phone:e.phone}));L(s)}catch(e){console.error("Lỗi khi lấy danh s\xe1ch bệnh viện:",e)}},e=>{console.error("Lỗi lấy vị tr\xed:",e),alert("Kh\xf4ng thể lấy vị tr\xed của bạn. Vui l\xf2ng bật định vị.")})},[]),(0,s.useEffect)(()=>{ei()},[]);let en=(0,N.useRouter)();(0,s.useEffect)(()=>{(async function(){if((null==e?void 0:e._id)&&S.role)try{if("donor"===S.role){let a=(await A.A.get("/users/donor-profile/active/".concat(e._id))).data.profile;if(I(a),null==a?void 0:a.hospital){let e=(await A.A.get("/hospital/".concat(a.hospital))).data.hospital.name;M(e=>({...e,hospitalId:a.hospital})),ea(e),X(e),U(!1),Y(-1)}M(e=>({...e,bloodType:a.blood_type||"",availability_date:a.availability_date?j(a.availability_date):"",certificateDonor:a.health_cert_url||""}))}else if("recipient"===S.role){let a=(await A.A.get("/users/recipient-profile/active/".concat(e._id))).data.profile;if(V(a),null==a?void 0:a.hospital){let e=(await A.A.get("/hospital/".concat(a.hospital))).data.hospital.name;M(e=>({...e,hospitalId:a.hospital})),ea(e),X(e),U(!1),Y(-1)}M(e=>({...e,hospital_name:a.hospital_name||"",certificateRecipient:a.medical_doc_url||""}))}}catch(e){console.warn("Kh\xf4ng t\xecm thấy profile:",e)}})()},[S.role]),(0,s.useEffect)(()=>{async function a(){var a,t;if(null==e?void 0:e._id){console.log(e._id);try{let t=await A.A.get("/users/donor-profile/active/".concat(e._id)),r=t.data.profile;I(r);let s=null===(a=t.data.profile)||void 0===a?void 0:a.hospital;if(s&&(null==e?void 0:e.role)==="donor"){let e=await A.A.get("/hospital/".concat(s));M(e=>({...e,hospitalId:r.hospital})),ea(e.data.hospital.name),X(e.data.hospital.name),U(!1),Y(-1)}M(a=>({...a,bloodType:r.blood_type||"",availability_date:r.availability_date?j(r.availability_date):"",certificateDonor:r.health_cert_url||"",name:(null==e?void 0:e.full_name)||"",email:(null==e?void 0:e.email)||"",phone:(null==e?void 0:e.phone)||"",address:(null==e?void 0:e.address)||"",gender:(null==e?void 0:e.gender)||"male",date_of_birth:(null==e?void 0:e.date_of_birth)?j(e.date_of_birth):"",role:(null==e?void 0:e.role)||"donor"}))}catch(e){console.warn("Kh\xf4ng t\xecm thấy donor profile:",e)}try{let a=await A.A.get("/users/recipient-profile/active/".concat(e._id)),r=a.data.profile;V(r);let s=null===(t=a.data.profile)||void 0===t?void 0:t.hospital;if(s&&(null==e?void 0:e.role)==="recipient"){let e=await A.A.get("/hospital/".concat(s));M(e=>({...e,hospitalId:r.hospital})),ea(e.data.hospital.name),X(e.data.hospital.name),U(!1),Y(-1)}M(a=>({...a,hospital_name:r.hospital_name||"",certificateRecipient:r.medical_doc_url||"",name:(null==e?void 0:e.full_name)||"",email:(null==e?void 0:e.email)||"",phone:(null==e?void 0:e.phone)||"",address:(null==e?void 0:e.address)||"",gender:(null==e?void 0:e.gender)||"male",date_of_birth:(null==e?void 0:e.date_of_birth)?j(e.date_of_birth):"",role:(null==e?void 0:e.role)||"recipient"}))}catch(e){console.warn("Kh\xf4ng t\xecm thấy recipient profile:",e)}P(!1)}}(null==e?void 0:e._id)&&a()},[e]);let eo=async t=>{if(t.preventDefault(),P(!0),B(""),!(null==e?void 0:e._id)){B("Phi\xean đăng nhập đ\xe3 hết hạn. Vui l\xf2ng đăng nhập lại."),P(!1);return}if(!S.agreeTerms){B("Vui l\xf2ng đồng \xfd với điều khoản sử dụng"),P(!1);return}try{let t=(await A.A.put("/users/edit/".concat(e._id),{full_name:S.name,email:S.email,phone:S.phone,gender:S.gender,date_of_birth:S.date_of_birth,address:S.address})).data;t.message?("donor"===S.role?(await A.A.put("/users/".concat(e._id,"/role"),{newRole:"donor"}),await A.A.post("/users/donor-profile",{user_id:e._id,blood_type:S.bloodType,availability_date:S.availability_date,health_cert_url:S.certificateDonor,hospital:S.hospitalId})):"recipient"===S.role&&(await A.A.put("/users/".concat(e._id,"/role"),{newRole:"recipient"}),await A.A.post("/users/recipient-profile",{user_id:e._id,medical_doc_url:S.certificateRecipient,hospital:S.hospitalId})),a({...e,full_name:S.name,email:S.email,phone:S.phone,gender:S.gender,date_of_birth:S.date_of_birth,address:S.address,role:S.role}),C.Ay.success("Cập nhật th\xf4ng tin th\xe0nh c\xf4ng!"),en.push("/user/dashboard")):B(t.message||"Kh\xf4ng thể cập nhật th\xf4ng tin.")}catch(e){console.error(e),B("Đ\xe3 xảy ra lỗi. Vui l\xf2ng thử lại.")}finally{P(!1)}};return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-red-50 via-pink-50 to-rose-100 flex flex-col relative overflow-hidden",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-grid-slate-100 opacity-30"}),(0,r.jsx)("div",{className:"absolute top-0 left-0 w-72 h-72 bg-gradient-to-br from-red-200/20 to-pink-200/20 rounded-full -translate-x-32 -translate-y-32 blur-3xl"}),(0,r.jsx)("div",{className:"absolute bottom-0 right-0 w-96 h-96 bg-gradient-to-br from-rose-200/20 to-red-200/20 rounded-full translate-x-32 translate-y-32 blur-3xl"}),(0,r.jsx)(w.Header,{}),(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center p-4 py-12 relative z-10",children:(0,r.jsxs)("div",{className:"w-full max-w-4xl",children:[(0,r.jsxs)("div",{className:"text-center mb-8 animate-fade-in",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold bg-gradient-to-r from-red-600 to-rose-600 bg-clip-text text-transparent mb-3",children:"Chỉnh sửa th\xf4ng tin"}),(0,r.jsx)("p",{className:"text-gray-600 text-lg",children:"Cập nhật th\xf4ng tin c\xe1 nh\xe2n của bạn"}),(0,r.jsx)("div",{className:"w-24 h-1 bg-gradient-to-r from-red-500 to-rose-500 mx-auto mt-4 rounded-full"})]}),(0,r.jsxs)(i.Zp,{className:"w-full shadow-2xl border-0 bg-white/90 backdrop-blur-sm transition-all duration-500 hover:shadow-3xl",children:[!1===$&&(0,r.jsxs)(h.Fc,{variant:"destructive",className:"mx-6 mt-6 border-red-200 bg-red-50/80 backdrop-blur-sm",children:[(0,r.jsx)(m.A,{className:"h-4 w-4"}),(0,r.jsx)(h.TN,{className:"text-red-800",children:"Bạn đ\xe3 từ chối chia sẻ vị tr\xed. Kh\xf4ng thể sử dụng chức năng t\xecm kiếm bệnh viện gần bạn."})]}),(0,r.jsxs)(i.aR,{className:"text-center space-y-4 pb-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500 animate-pulse"}),(0,r.jsx)(i.ZB,{className:"text-2xl font-semibold text-gray-800",children:"Th\xf4ng tin c\xe1 nh\xe2n"}),(0,r.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500 animate-pulse"})]}),(0,r.jsx)(i.BT,{className:"text-gray-600",children:"Vui l\xf2ng cập nhật th\xf4ng tin ch\xednh x\xe1c để đảm bảo an to\xe0n"})]}),(0,r.jsxs)(i.Wu,{className:"px-8 pb-8",children:[(0,r.jsxs)("form",{onSubmit:eo,className:"space-y-8",children:[R&&(0,r.jsxs)(h.Fc,{variant:"destructive",className:"border-red-200 bg-red-50/80 backdrop-blur-sm animate-shake",children:[(0,r.jsx)(m.A,{className:"h-4 w-4"}),(0,r.jsx)(h.TN,{className:"text-red-800",children:R})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-red-500 to-rose-500 flex items-center justify-center",children:(0,r.jsx)(x.A,{className:"h-4 w-4 text-white"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Th\xf4ng tin c\xe1 nh\xe2n"}),(0,r.jsx)("div",{className:"flex-1 h-px bg-gradient-to-r from-red-200 to-transparent"})]}),(0,r.jsxs)("div",{className:"grid lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-3 group",children:[(0,r.jsxs)(o.J,{htmlFor:"name",className:"text-sm font-medium text-gray-700 flex items-center",children:["Họ v\xe0 t\xean ",(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(x.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 group-focus-within:text-red-500 transition-colors"}),(0,r.jsx)(n.p,{id:"name",placeholder:"Nguyễn Văn A",value:S.name,onChange:e=>M(a=>({...a,name:e.target.value})),className:"pl-10 h-12 border-gray-200 focus:border-red-500 focus:ring-red-500 transition-all duration-300 hover:border-gray-300",required:!0})]})]}),"donor"===S.role&&(0,r.jsxs)("div",{className:"space-y-3 group",children:[(0,r.jsxs)(o.J,{htmlFor:"bloodType",className:"text-sm font-medium text-gray-700 flex items-center",children:["Nh\xf3m m\xe1u ",(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsxs)(d.l6,{value:S.bloodType,onValueChange:e=>M(a=>({...a,bloodType:e})),children:[(0,r.jsx)(d.bq,{className:"h-12 border-gray-200 focus:border-red-500 focus:ring-red-500 transition-all duration-300 hover:border-gray-300",children:(0,r.jsx)(d.yv,{placeholder:"Chọn nh\xf3m m\xe1u"})}),(0,r.jsxs)(d.gC,{className:"bg-white/95 backdrop-blur-sm",children:[(0,r.jsx)(d.eb,{value:"unknown",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(g.A,{className:"w-4 h-4 mr-2 text-gray-500"}),"Chưa biết"]})},"unknown"),["O-","O+","A-","A+","B-","B+","AB-","AB+"].map(e=>(0,r.jsx)(d.eb,{value:e,children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(g.A,{className:"w-4 h-4 mr-2 text-red-500"}),e]})},e))]})]})]})]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-cyan-500 flex items-center justify-center",children:(0,r.jsx)(u.A,{className:"h-4 w-4 text-white"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Th\xf4ng tin li\xean lạc"}),(0,r.jsx)("div",{className:"flex-1 h-px bg-gradient-to-r from-blue-200 to-transparent"})]}),(0,r.jsxs)("div",{className:"grid lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-3 group",children:[(0,r.jsxs)(o.J,{htmlFor:"email",className:"text-sm font-medium text-gray-700 flex items-center",children:["Email ",(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(u.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,r.jsx)(n.p,{id:"email",type:"email",placeholder:"email@example.com",value:S.email,onChange:e=>M(a=>({...a,email:e.target.value})),className:"pl-10 h-12 border-gray-200 bg-gray-50 transition-all duration-300",disabled:!0})]})]}),("donor"===S.role||"recipient"===S.role)&&(0,r.jsx)(r.Fragment,{children:"donor"===S.role&&(0,r.jsxs)("div",{className:"space-y-3 group",children:[(0,r.jsxs)(o.J,{htmlFor:"dbd",className:"text-sm font-medium text-gray-700 flex items-center",children:["Ng\xe0y bắt đầu hiến m\xe1u ",(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(p.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 group-focus-within:text-red-500 transition-colors"}),(0,r.jsx)(n.p,{id:"dbd",type:"date",min:et,value:S.availability_date,onChange:e=>M(a=>({...a,availability_date:e.target.value})),className:"pl-10 h-12 border-gray-200 focus:border-red-500 focus:ring-red-500 transition-all duration-300 hover:border-gray-300",required:!0})]})]})})]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-green-500 to-emerald-500 flex items-center justify-center",children:(0,r.jsx)(f.A,{className:"h-4 w-4 text-white"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Chi tiết c\xe1 nh\xe2n"}),(0,r.jsx)("div",{className:"flex-1 h-px bg-gradient-to-r from-green-200 to-transparent"})]}),(0,r.jsxs)("div",{className:"grid lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-3 group",children:[(0,r.jsxs)(o.J,{htmlFor:"phone",className:"text-sm font-medium text-gray-700 flex items-center",children:["Số điện thoại ",(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(f.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 group-focus-within:text-green-500 transition-colors"}),(0,r.jsx)(n.p,{id:"phone",type:"tel",placeholder:"0901234567",value:S.phone||"",onChange:e=>M(a=>({...a,phone:e.target.value})),className:"pl-10 h-12 border-gray-200 focus:border-green-500 focus:ring-green-500 transition-all duration-300 hover:border-gray-300",required:!0})]})]}),("donor"===S.role||"recipient"===S.role)&&(0,r.jsxs)(r.Fragment,{children:["donor"===S.role&&(0,r.jsxs)("div",{className:"space-y-3 group",children:[(0,r.jsxs)(o.J,{htmlFor:"certificateDonor",className:"text-sm font-medium text-gray-700 flex items-center",children:["Ảnh giấy chứng nhận sức khỏe ",(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsx)("div",{className:"border-2 border-dashed border-gray-200 rounded-lg p-4 hover:border-green-400 transition-all duration-300 group-focus-within:border-green-500",children:(0,r.jsx)(T.A,{id:"certificateDonor",value:S.certificateDonor,onChange:e=>M(a=>({...a,certificateDonor:e}))})})]}),"recipient"===S.role&&(0,r.jsxs)("div",{className:"space-y-3 group",children:[(0,r.jsxs)(o.J,{htmlFor:"certificateRecipient",className:"text-sm font-medium text-gray-700 flex items-center",children:["Ảnh giấy chứng nhận y tế ",(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsx)("div",{className:"border-2 border-dashed border-gray-200 rounded-lg p-4 hover:border-green-400 transition-all duration-300 group-focus-within:border-green-500",children:(0,r.jsx)(T.A,{id:"certificateRecipient",value:S.certificateRecipient,onChange:e=>M(a=>({...a,certificateRecipient:e}))})})]})]})]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-purple-500 to-indigo-500 flex items-center justify-center",children:(0,r.jsx)(v.A,{className:"h-4 w-4 text-white"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Vai tr\xf2 v\xe0 Bệnh viện"}),(0,r.jsx)("div",{className:"flex-1 h-px bg-gradient-to-r from-purple-200 to-transparent"})]}),(0,r.jsxs)("div",{className:"grid lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-3 group",children:[(0,r.jsxs)(o.J,{htmlFor:"role",className:"text-sm font-medium text-gray-700 flex items-center",children:["Vai tr\xf2 ",(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsxs)(d.l6,{value:S.role,onValueChange:e=>M(a=>({...a,role:e})),children:[(0,r.jsx)(d.bq,{className:"h-12 border-gray-200 focus:border-purple-500 focus:ring-purple-500 transition-all duration-300 hover:border-gray-300",children:(0,r.jsx)(d.yv,{placeholder:"Chọn vai tr\xf2"})}),(0,r.jsxs)(d.gC,{className:"bg-white/95 backdrop-blur-sm",children:[(0,r.jsx)(d.eb,{value:"donor",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(g.A,{className:"w-4 h-4 mr-2 text-red-500"}),"Người hiến m\xe1u (Donor)"]})}),(0,r.jsx)(d.eb,{value:"recipient",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(x.A,{className:"w-4 h-4 mr-2 text-blue-500"}),"Người nhận m\xe1u (Recipient)"]})})]})]})]}),(0,r.jsxs)("div",{className:"space-y-3 relative group",children:[(0,r.jsxs)(o.J,{htmlFor:"hospital_name",className:"text-sm font-medium text-gray-700 flex items-center",children:["T\xean bệnh viện ",(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(v.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 group-focus-within:text-purple-500 transition-colors"}),(0,r.jsx)(n.p,{id:"hospital_name",placeholder:"ex: Bệnh viện H\xf9ng Vương",value:ee,onChange:e=>{X(e.target.value),ea(e.target.value),U(!0),Y(-1)},onKeyDown:e=>{if(G){if("ArrowDown"===e.key){let a=(W+1)%el.length;Y(a),ea(el[a].name),e.preventDefault()}else if("ArrowUp"===e.key){let a=(W-1+el.length)%el.length;Y(a),ea(el[a].name),e.preventDefault()}else"Enter"===e.key&&W>=0&&(er(el[W]),e.preventDefault())}},className:"pl-10 h-12 border-gray-200 focus:border-purple-500 focus:ring-purple-500 transition-all duration-300 hover:border-gray-300",required:!0,disabled:!1===$})]}),G&&el.length>0&&(0,r.jsx)("ul",{className:"absolute z-20 bg-white/95 backdrop-blur-sm border border-gray-200 w-full max-h-60 overflow-y-auto shadow-xl rounded-lg mt-1 custom-scrollbar",children:el.map((e,a)=>(0,r.jsx)("li",{ref:W===a?e=>null==e?void 0:e.scrollIntoView({block:"nearest"}):null,className:"px-4 py-3 hover:bg-purple-50 cursor-pointer transition-all duration-200 border-l-4 ".concat(W===a?"bg-purple-100 border-purple-500 shadow-md transform translate-x-1":"border-transparent hover:border-purple-300"),onClick:()=>er(e),children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)(v.A,{className:"w-4 h-4 text-purple-500 mt-0.5 flex-shrink-0"}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("strong",{className:"text-gray-800 block truncate",children:e.name}),e.address&&(0,r.jsx)("div",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:e.address})]})]})},a))})]})]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-orange-500 to-amber-500 flex items-center justify-center",children:(0,r.jsx)(p.A,{className:"h-4 w-4 text-white"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Th\xf4ng tin sinh học"}),(0,r.jsx)("div",{className:"flex-1 h-px bg-gradient-to-r from-orange-200 to-transparent"})]}),(0,r.jsxs)("div",{className:"grid lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-3 group",children:[(0,r.jsxs)(o.J,{htmlFor:"dob",className:"text-sm font-medium text-gray-700 flex items-center",children:["Ng\xe0y sinh ",(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(p.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 group-focus-within:text-orange-500 transition-colors"}),(0,r.jsx)(n.p,{id:"dob",type:"date",value:S.date_of_birth,onChange:e=>M(a=>({...a,date_of_birth:e.target.value})),className:"pl-10 h-12 border-gray-200 focus:border-orange-500 focus:ring-orange-500 transition-all duration-300 hover:border-gray-300",required:!0})]})]}),(0,r.jsxs)("div",{className:"space-y-3 group",children:[(0,r.jsxs)(o.J,{htmlFor:"gender",className:"text-sm font-medium text-gray-700 flex items-center",children:["Giới t\xednh ",(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsxs)(d.l6,{value:S.gender,onValueChange:e=>M(a=>({...a,gender:e})),children:[(0,r.jsx)(d.bq,{className:"h-12 border-gray-200 focus:border-orange-500 focus:ring-orange-500 transition-all duration-300 hover:border-gray-300",children:(0,r.jsx)(d.yv,{placeholder:"Chọn giới t\xednh"})}),(0,r.jsx)(d.gC,{className:"bg-white/95 backdrop-blur-sm",children:["male","female","other"].map(e=>(0,r.jsx)(d.eb,{value:e,children:(0,r.jsxs)("div",{className:"flex items-center capitalize",children:[(0,r.jsx)(x.A,{className:"w-4 h-4 mr-2 text-orange-500"}),"male"===e?"Nam":"female"===e?"Nữ":"Kh\xe1c"]})},e))})]})]})]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-teal-500 to-cyan-500 flex items-center justify-center",children:(0,r.jsx)(v.A,{className:"h-4 w-4 text-white"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Vị tr\xed v\xe0 T\xecm kiếm"}),(0,r.jsx)("div",{className:"flex-1 h-px bg-gradient-to-r from-teal-200 to-transparent"})]}),(0,r.jsxs)("div",{className:"grid lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-3 group",children:[(0,r.jsxs)(o.J,{htmlFor:"address",className:"text-sm font-medium text-gray-700 flex items-center",children:["Địa chỉ ",(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(v.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 group-focus-within:text-teal-500 transition-colors"}),(0,r.jsx)("div",{className:"pl-10",children:(0,r.jsx)(F,{value:S.address||"",onChange:e=>M(a=>({...a,address:e}))})})]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)(o.J,{htmlFor:"radiusKm",className:"text-sm font-medium text-gray-700 flex items-center",children:["Khoảng c\xe1ch t\xecm bệnh viện (km) ",(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsx)(n.p,{id:"radiusKm",type:"number",placeholder:"VD: 30",value:z,onChange:e=>H(Number(e.target.value)),className:"h-12 border-gray-200 focus:border-teal-500 focus:ring-teal-500 transition-all duration-300 hover:border-gray-300",required:!0,disabled:!1===$}),(0,r.jsxs)(l.$,{type:"button",onClick:()=>{if(!navigator.geolocation){C.Ay.error("Tr\xecnh duyệt kh\xf4ng hỗ trợ định vị!");return}navigator.geolocation.getCurrentPosition(async e=>{let{latitude:a,longitude:t}=e.coords;try{let e=(await A.A.get("/hospital/")).data.hospitals,r=(e,a,t,r)=>{let s=(t-e)*Math.PI/180,l=(r-a)*Math.PI/180,i=Math.sin(s/2)**2+Math.cos(e*Math.PI/180)*Math.cos(t*Math.PI/180)*Math.sin(l/2)**2,n=2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i));return 6371*n},s=e.filter(e=>r(a,t,e.latitude,e.longitude)<=z).map(e=>({_id:e._id,name:e.name,address:e.address,phone:e.phone}));L(s),s.length>0?C.Ay.success("T\xecm thấy ".concat(s.length," bệnh viện trong ").concat(z," km!")):C.Ay.error("Kh\xf4ng t\xecm thấy bệnh viện n\xe0o trong ".concat(z," km."))}catch(e){console.error("Lỗi lấy danh s\xe1ch bệnh viện:",e),C.Ay.error("Đ\xe3 xảy ra lỗi khi t\xecm bệnh viện!")}},e=>{console.error("Người d\xf9ng từ chối chia sẻ vị tr\xed:",e),C.Ay.error("Bạn đ\xe3 từ chối chia sẻ vị tr\xed, kh\xf4ng thể t\xecm kiếm bệnh viện gần bạn.")})},className:"w-full h-12 bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white font-medium transition-all duration-300 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",disabled:!1===$,children:[(0,r.jsx)(v.A,{className:"w-4 h-4 mr-2"}),"T\xecm bệnh viện gần bạn"]})]})]})]}),(0,r.jsx)("div",{className:"space-y-6 pt-6 border-t border-gray-100",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3 p-4 bg-gradient-to-r from-red-50 to-rose-50 rounded-lg border border-red-100",children:[(0,r.jsx)(c.S,{id:"agreeTerms",checked:S.agreeTerms,onCheckedChange:e=>M(a=>({...a,agreeTerms:e})),required:!0,className:"mt-1 data-[state=checked]:bg-red-500 data-[state=checked]:border-red-500"}),(0,r.jsxs)(o.J,{htmlFor:"agreeTerms",className:"text-sm leading-6 text-gray-700 cursor-pointer",children:["T\xf4i đồng \xfd với"," ",(0,r.jsx)(y(),{href:"/terms",className:"text-red-600 hover:text-red-700 underline font-medium transition-colors",children:"điều khoản sử dụng"})," ","v\xe0"," ",(0,r.jsx)(y(),{href:"/privacy",className:"text-red-600 hover:text-red-700 underline font-medium transition-colors",children:"ch\xednh s\xe1ch bảo mật"}),". T\xf4i cam kết th\xf4ng tin cung cấp l\xe0 ch\xednh x\xe1c v\xe0 đồng \xfd tham gia hiến m\xe1u t\xecnh nguyện."]})]}),(0,r.jsx)(l.$,{type:"submit",className:"w-full h-14 bg-gradient-to-r from-red-500 to-rose-500 hover:from-red-600 hover:to-rose-600 text-white font-semibold text-lg transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",disabled:J,children:J?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}),"Đang cập nhật th\xf4ng tin..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.A,{className:"w-5 h-5 mr-3"}),"Cập nhật th\xf4ng tin"]})})]})})]}),(0,r.jsx)("div",{className:"text-center mt-8 pt-6 border-t border-gray-100",children:(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Đ\xe3 c\xf3 t\xe0i khoản?"," ",(0,r.jsx)(y(),{href:"/login",className:"text-red-600 hover:text-red-700 underline font-medium transition-colors",children:"Đăng nhập ngay"})]})})]})]})]})}),(0,r.jsx)(C.l$,{position:"top-center",containerStyle:{top:80},toastOptions:{duration:4e3,style:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)"},success:{iconTheme:{primary:"#10B981",secondary:"white"}},error:{iconTheme:{primary:"#EF4444",secondary:"white"}}}}),(0,r.jsx)(_.Footer,{})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[3064,6237,6222,3464,3568,461,1975,7949,6555,8441,1684,7358],()=>a(3095)),_N_E=e.O()}]);